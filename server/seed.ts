import prisma from './lib/database';
import { hashPassword } from './lib/auth';

async function main() {
  console.log('üå± Iniciando seed do banco de dados...');

  // Criar exerc√≠cios base
  const exercises = [
    // Peito
    {
      name: 'Supino Reto com Halteres',
      muscle: 'Peitoral',
      category: 'Peito',
      equipment: ['Halteres', 'Banco'],
      instructions: [
        'Deite no banco com os halteres nas m√£os',
        'Abaixe os halteres controladamente at√© o peito',
        'Empurre de volta √† posi√ß√£o inicial',
        'Mantenha os ombros est√°veis'
      ],
      tips: 'Foque na contra√ß√£o do peito e n√£o arqueie demais as costas',
      difficulty: 'intermediate'
    },
    {
      name: 'Crucifixo Inclinado',
      muscle: 'Peitoral Superior',
      category: 'Peito',
      equipment: ['Halteres', 'Banco Inclinado'],
      instructions: [
        'Deite no banco inclinado (30-45¬∞)',
        'Abra os bra√ßos em movimento de arco',
        'Sinta o alongamento no peito',
        'Retorne controladamente'
      ],
      tips: 'Mantenha uma leve flex√£o nos cotovelos durante todo movimento',
      difficulty: 'intermediate'
    },
    {
      name: 'Flex√£o de Bra√ßo',
      muscle: 'Peitoral/Tr√≠ceps',
      category: 'Peito',
      equipment: ['Peso Corporal'],
      instructions: [
        'Posi√ß√£o de prancha com m√£os afastadas',
        'Des√ßa at√© o peito quase tocar o ch√£o',
        'Empurre de volta',
        'Mantenha o core contra√≠do'
      ],
      tips: 'Se muito dif√≠cil, apoie os joelhos no ch√£o',
      difficulty: 'beginner'
    },
    // Tr√≠ceps
    {
      name: 'Tr√≠ceps Testa com Halteres',
      muscle: 'Tr√≠ceps',
      category: 'Bra√ßos',
      equipment: ['Halteres', 'Banco'],
      instructions: [
        'Deite no banco com halteres acima do peito',
        'Flexione apenas os cotovelos',
        'Des√ßa em dire√ß√£o √† testa',
        'Estenda de volta'
      ],
      tips: 'Mantenha os cotovelos fixos, movimento s√≥ no antebra√ßo',
      difficulty: 'intermediate'
    },
    {
      name: 'Mergulho em Paralelas',
      muscle: 'Tr√≠ceps/Peito Inferior',
      category: 'Bra√ßos',
      equipment: ['Paralelas', 'Peso Corporal'],
      instructions: [
        'Apoie-se nas paralelas',
        'Des√ßa flexionando os cotovelos',
        'Empurre de volta √† posi√ß√£o inicial',
        'Incline-se ligeiramente para frente'
      ],
      tips: 'Se muito dif√≠cil, use uma cadeira ou apoio nos p√©s',
      difficulty: 'intermediate'
    },
    // Costas
    {
      name: 'Remada Curvada com Halteres',
      muscle: 'Lat√≠ssimo/Romboides',
      category: 'Costas',
      equipment: ['Halteres'],
      instructions: [
        'Incline o tronco para frente',
        'Puxe os halteres em dire√ß√£o ao abdome',
        'Aperte as esc√°pulas',
        'Controle a descida'
      ],
      tips: 'Mantenha a coluna neutra e foque em puxar com as costas',
      difficulty: 'intermediate'
    },
    {
      name: 'Puxada Alta',
      muscle: 'Lat√≠ssimo',
      category: 'Costas',
      equipment: ['Polia', 'Barra'],
      instructions: [
        'Sente-se na m√°quina com as coxas fixas',
        'Segure a barra com pegada larga',
        'Puxe em dire√ß√£o ao peito',
        'Controle a subida'
      ],
      tips: 'N√£o balance o corpo, use apenas os m√∫sculos das costas',
      difficulty: 'intermediate'
    },
    // B√≠ceps
    {
      name: 'Rosca Direta com Halteres',
      muscle: 'B√≠ceps',
      category: 'Bra√ßos',
      equipment: ['Halteres'],
      instructions: [
        'Fique em p√© com halteres nas m√£os',
        'Mantenha os cotovelos fixos ao lado do corpo',
        'Flexione os bra√ßos levando os halteres ao peito',
        'Des√ßa controladamente'
      ],
      tips: 'Evite balan√ßar o corpo, foque no movimento do b√≠ceps',
      difficulty: 'beginner'
    },
    // Pernas
    {
      name: 'Agachamento Livre',
      muscle: 'Quadr√≠ceps/Gl√∫teos',
      category: 'Pernas',
      equipment: ['Peso Corporal'],
      instructions: [
        'Fique em p√© com p√©s afastados na largura dos ombros',
        'Des√ßa como se fosse sentar numa cadeira',
        'Mantenha o peso nos calcanhares',
        'Suba empurrando o ch√£o'
      ],
      tips: 'Mantenha o peito erguido e joelhos alinhados com os p√©s',
      difficulty: 'beginner'
    },
    {
      name: 'Leg Press 45¬∞',
      muscle: 'Quadr√≠ceps/Gl√∫teos',
      category: 'Pernas',
      equipment: ['Leg Press'],
      instructions: [
        'Sente-se no aparelho com as costas apoiadas',
        'Posicione os p√©s na plataforma',
        'Des√ßa at√© formar 90¬∞ nos joelhos',
        'Empurre de volta sem travar totalmente'
      ],
      tips: 'N√£o des√ßa demais para n√£o sobrecarregar os joelhos',
      difficulty: 'intermediate'
    },
    {
      name: 'Stiff com Halteres',
      muscle: 'Posterior da Coxa/Gl√∫teos',
      category: 'Pernas',
      equipment: ['Halteres'],
      instructions: [
        'Fique em p√© com halteres na frente das coxas',
        'Des√ßa os halteres deslizando pelas pernas',
        'Mantenha as pernas semi-flexionadas',
        'Sinta o alongamento na parte de tr√°s das coxas'
      ],
      tips: 'Movimento deve vir do quadril, n√£o da coluna',
      difficulty: 'intermediate'
    },
    // Ombros
    {
      name: 'Desenvolvimento com Halteres',
      muscle: 'Deltoides',
      category: 'Ombros',
      equipment: ['Halteres', 'Banco'],
      instructions: [
        'Sente-se com halteres na altura dos ombros',
        'Empurre os halteres para cima',
        'N√£o trave totalmente os cotovelos',
        'Des√ßa controladamente'
      ],
      tips: 'Mantenha o core contra√≠do para proteger a lombar',
      difficulty: 'intermediate'
    },
    {
      name: 'Eleva√ß√£o Lateral',
      muscle: 'Deltoides M√©dio',
      category: 'Ombros',
      equipment: ['Halteres'],
      instructions: [
        'Fique em p√© com halteres ao lado do corpo',
        'Eleve os bra√ßos lateralmente at√© a altura dos ombros',
        'Pause no topo do movimento',
        'Des√ßa controladamente'
      ],
      tips: 'Use peso moderado e foque na t√©cnica',
      difficulty: 'intermediate'
    }
  ];

  console.log('üìù Criando exerc√≠cios...');
  for (const exerciseData of exercises) {
    await prisma.exercise.upsert({
      where: { name: exerciseData.name },
      update: {},
      create: exerciseData
    });
  }

  // Criar usu√°rio de demonstra√ß√£o
  const demoUserEmail = 'demo@fitplan.com';
  const demoUserPassword = await hashPassword('123456');

  console.log('üë§ Criando usu√°rio de demonstra√ß√£o...');
  const demoUser = await prisma.user.upsert({
    where: { email: demoUserEmail },
    update: {},
    create: {
      name: 'Usu√°rio Demo',
      email: demoUserEmail,
      password: demoUserPassword,
    },
  });

  // Criar perfil para o usu√°rio demo
  console.log('üìä Criando perfil do usu√°rio demo...');
  await prisma.userProfile.upsert({
    where: { userId: demoUser.id },
    update: {},
    create: {
      userId: demoUser.id,
      bodyType: 'ectomorfo',
      currentWeight: 62.0,
      targetWeight: 70.0,
      height: 1.75,
      age: 25,
      gender: 'masculino',
      goal: 'ganhar-peso',
      timeframe: '6 meses',
      budget: 400.0,
      activityLevel: 'leve',
      preferences: {
        allergies: [],
        dislikes: ['camar√£o'],
        vegetarian: false,
        vegan: false
      }
    },
  });

  // Criar plano de treino demo
  console.log('üí™ Criando plano de treino demo...');
  
  // Verificar se j√° existe um plano para este usu√°rio
  let workoutPlan = await prisma.workoutPlan.findFirst({
    where: { 
      userId: demoUser.id,
      name: 'Plano Ganho de Massa - Iniciante'
    }
  });

  if (!workoutPlan) {
    workoutPlan = await prisma.workoutPlan.create({
      data: {
        userId: demoUser.id,
        name: 'Plano Ganho de Massa - Iniciante',
        description: 'Plano focado em ganho de massa muscular para ectomorfos iniciantes',
        duration: '8 semanas',
        difficulty: 'beginner',
        isActive: true,
      },
    });
  }

  // Criar treinos da semana
  const workouts = [
    {
      name: 'Peito e Tr√≠ceps',
      day: 'Segunda-feira',
      dayOfWeek: 1,
      duration: '45-60 min',
      muscleGroups: ['Peito', 'Tr√≠ceps'],
      exercises: [
        { exerciseName: 'Supino Reto com Halteres', sets: 4, reps: '8-12', weight: '15kg cada', restTime: '60-90s', order: 1 },
        { exerciseName: 'Crucifixo Inclinado', sets: 3, reps: '10-15', weight: '12kg cada', restTime: '45-60s', order: 2 },
        { exerciseName: 'Flex√£o de Bra√ßo', sets: 3, reps: 'M√°ximo', weight: 'Peso corporal', restTime: '45s', order: 3 },
        { exerciseName: 'Tr√≠ceps Testa com Halteres', sets: 4, reps: '10-12', weight: '8kg cada', restTime: '60s', order: 4 },
        { exerciseName: 'Mergulho em Paralelas', sets: 3, reps: '8-15', weight: 'Peso corporal', restTime: '60s', order: 5 }
      ]
    },
    {
      name: 'Costas e B√≠ceps',
      day: 'Ter√ßa-feira',
      dayOfWeek: 2,
      duration: '45-60 min',
      muscleGroups: ['Costas', 'B√≠ceps'],
      exercises: [
        { exerciseName: 'Remada Curvada com Halteres', sets: 4, reps: '8-12', weight: '15kg cada', restTime: '60-90s', order: 1 },
        { exerciseName: 'Puxada Alta', sets: 4, reps: '10-12', weight: '40kg', restTime: '60s', order: 2 },
        { exerciseName: 'Rosca Direta com Halteres', sets: 3, reps: '10-15', weight: '10kg cada', restTime: '45s', order: 3 }
      ]
    },
    {
      name: 'Pernas e Gl√∫teos',
      day: 'Quinta-feira',
      dayOfWeek: 4,
      duration: '50-70 min',
      muscleGroups: ['Pernas', 'Gl√∫teos'],
      exercises: [
        { exerciseName: 'Agachamento Livre', sets: 4, reps: '12-15', weight: 'Peso corporal', restTime: '60-90s', order: 1 },
        { exerciseName: 'Leg Press 45¬∞', sets: 4, reps: '15-20', weight: '60kg', restTime: '60s', order: 2 },
        { exerciseName: 'Stiff com Halteres', sets: 3, reps: '12-15', weight: '12kg cada', restTime: '45s', order: 3 }
      ]
    },
    {
      name: 'Ombros e Bra√ßos',
      day: 'Sexta-feira',
      dayOfWeek: 5,
      duration: '40-50 min',
      muscleGroups: ['Ombros', 'Bra√ßos'],
      exercises: [
        { exerciseName: 'Desenvolvimento com Halteres', sets: 4, reps: '8-12', weight: '12kg cada', restTime: '60s', order: 1 },
        { exerciseName: 'Eleva√ß√£o Lateral', sets: 3, reps: '12-15', weight: '6kg cada', restTime: '45s', order: 2 },
        { exerciseName: 'Rosca Direta com Halteres', sets: 3, reps: '10-12', weight: '10kg cada', restTime: '45s', order: 3 }
      ]
    }
  ];

  console.log('üèãÔ∏è Criando treinos da semana...');
  for (const workoutData of workouts) {
    const workout = await prisma.workout.create({
      data: {
        workoutPlanId: workoutPlan.id,
        name: workoutData.name,
        day: workoutData.day,
        dayOfWeek: workoutData.dayOfWeek,
        duration: workoutData.duration,
        muscleGroups: workoutData.muscleGroups,
      },
    });

    // Adicionar exerc√≠cios ao treino
    for (const exerciseData of workoutData.exercises) {
      const exercise = await prisma.exercise.findFirst({
        where: { name: exerciseData.exerciseName }
      });

      if (exercise) {
        await prisma.workoutExercise.create({
          data: {
            workoutId: workout.id,
            exerciseId: exercise.id,
            sets: exerciseData.sets,
            reps: exerciseData.reps,
            weight: exerciseData.weight,
            restTime: exerciseData.restTime,
            order: exerciseData.order,
          },
        });
      }
    }
  }

  console.log('‚úÖ Seed conclu√≠do com sucesso!');
  console.log(`üìß Usu√°rio demo: ${demoUserEmail}`);
  console.log(`üîë Senha demo: 123456`);
}

main()
  .catch((e) => {
    console.error('‚ùå Erro durante o seed:', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  }); 